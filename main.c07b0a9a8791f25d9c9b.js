(window.webpackJsonp=window.webpackJsonp||[]).push([[0],[,function(e,t,i){"use strict";i.r(t);var a=i(0),n=function(e,t,i,a,n){var o=this;if(!(e instanceof HTMLElement))throw Error("[MobileWidgetControls] Expected element to be an HTMLElement.");var r="ontouchstart"in window||navigator.msMaxTouchPoints>0,l=window.innerWidth,s=window.innerHeight,d=window.devicePixelRatio;document.body.style.overflowX="hidden",document.body.style.overflowY="hidden",this.element=e,this.leftStickMoveCallback=t,this.rightStickMoveCallback=i,this.buttonPressCallback=a,this.controllerType=n||"default",this.currentDPR=d,this.initialDPR=d,this.CANVAS_ID="widget-drawing-canvas",this.TIME_MS_TO_GET_TO_ORIGINAL_POSITION=60,this.minOpacity=.1,this.leftStick={},this.rightStick={},this.buttons=[],this.fingers=[];var h=document.getElementById(this.CANVAS_ID);h?this.canvas=h:(this.canvas=document.createElement("canvas"),this.canvas.setAttribute("id",this.CANVAS_ID),this.canvas.setAttribute("width","".concat(l)),this.canvas.setAttribute("height","".concat(s)),this.canvas.setAttribute("style","position: absolute; width: 100%; bottom: 0px; z-index: 999;"),this.element.appendChild(this.canvas)),r||(this.element.addEventListener("mousemove",(function(e){return o.updateMove(e)})),this.element.addEventListener("mousedown",(function(e){return o.updateDown(e)})),this.element.addEventListener("mouseup",(function(e){return o.updateUp(e)}))),window.addEventListener("resize",(function(){return o.resize()})),window.addEventListener("orientationchange",(function(){return o.resize()}));var c=function(e){return function(t){if("start"===e&&t.preventDefault(),"move"===e&&(t.preventDefault(),t.stopPropagation()),o.fingers=[],"cancel"!==e){for(var i=t.touches,a=0;a<i.length;++a){var n=i[a],r=n.clientX,l=n.clientY;o.fingers.push({x:r,y:l})}for(var s=t.changedTouches,d=0;d<s.length;++d){var h=s[d];"end"===e?o.updateUp(h):"move"===e?o.updateMove(h):"start"===e&&o.updateDown(h)}}else console.error("[MobileWidgetControls] Too many fingers or unsupported action.")}};this.canvas.addEventListener("touchstart",c("start"),!1),this.canvas.addEventListener("touchmove",c("move"),!1),this.canvas.addEventListener("touchend",c("end"),!1),this.canvas.addEventListener("touchcancel",c("cancel"),!1),this._resizeRequest=null,this.init()};n.prototype.init=function(){var e=window.innerHeight,t=window.innerWidth;this.canvas.style.width="".concat(t,"px"),this.canvas.style.height="".concat(e,"px");var i=window.devicePixelRatio;i!==this.currentDPR&&(console.log("[MobileWidgetControls] Zoom triggered: updating DPR."),this.currentDPR=i);var a=i*t,n=i*e;this.canvas.width=a,this.canvas.height=n;var o=this.controllerType;this.initButtons(o,a,n),this.initSticks(o,a,n),this.draw()},n.PlaystationControllerButtons=[{name:"cross",from:"r",x:85,y:75,label:String.fromCharCode(10761),labelSize:30,diameter:30,labelOffset:2,theme:"gradient"},{name:"circle",from:"r",x:40,y:120,labelSize:23,diameter:30,label:String.fromCharCode(9711),labelOffset:2,theme:"gradient"},{name:"square",from:"r",x:130,y:120,labelSize:36,diameter:30,label:String.fromCharCode(9723),labelOffset:2,theme:"gradient"},{name:"triangle",from:"r",x:85,y:165,labelSize:35,diameter:30,label:String.fromCharCode(9651),labelOffset:0,theme:"gradient"},{name:"L1",from:"l",x:110,y:260,labelSize:30,diameter:30,label:"L1",labelOffset:3,theme:"gradient"},{name:"R1",from:"r",x:110,y:260,labelSize:30,diameter:30,label:"R1",labelOffset:3,theme:"gradient"},{name:"L2",from:"l",x:50,y:280,labelSize:30,diameter:30,label:"L2",labelOffset:3,theme:"gradient"},{name:"R2",from:"r",x:50,y:280,labelSize:30,diameter:30,label:"R2",labelOffset:3,theme:"gradient"},{name:"back"},{name:"forward"},{name:"stickLB"},{name:"stickRB"},{name:"dpadUp",from:"l",x:65,y:205,label:String.fromCharCode(8593),labelSize:20,diameter:23,labelOffset:0,theme:"gradient"},{name:"dpadDown",from:"l",x:65,y:135,label:String.fromCharCode(8595),labelSize:20,diameter:23,labelOffset:0,theme:"gradient"},{name:"dpadLeft",from:"l",x:30,y:170,label:String.fromCharCode(8592),labelSize:20,diameter:23,labelOffset:0,theme:"gradient"},{name:"dpadRight",from:"l",x:100,y:170,label:String.fromCharCode(8594),labelSize:20,diameter:23,labelOffset:0,theme:"gradient"},{name:"home"}],n.XBoxControllerButtons=[{name:"A",from:"r",diameter:25,x:80,y:35,label:"A",labelSize:20,labelOffset:2},{name:"B",from:"r",diameter:25,x:45,y:75,label:"B",labelSize:20,labelOffset:2},{name:"X",from:"r",diameter:25,x:115,y:75,label:"X",labelSize:20,labelOffset:2},{name:"Y",from:"r",diameter:25,x:80,y:115,label:"Y",labelSize:20,labelOffset:2},{name:"LB",from:"l",diameter:35,x:135,y:205,label:"LB",labelSize:20,labelOffset:2},{name:"RB",from:"r",diameter:35,x:130,y:180,label:"RB",labelSize:20,labelOffset:2},{name:"LT",from:"l",diameter:35,x:45,y:210,label:"LT",labelSize:20,labelOffset:2},{name:"RT",from:"r",diameter:35,x:45,y:200,label:"RT",labelSize:20,labelOffset:2},{name:"back"},{name:"forward"},{name:"stickLB"},{name:"stickRB"},{name:"dpadUp",from:"l",diameter:15,x:220,y:73,label:String.fromCharCode(8593),labelSize:20,labelOffset:0},{name:"dpadDown",from:"l",diameter:15,x:220,y:27,label:String.fromCharCode(8595),labelSize:20,labelOffset:0},{name:"dpadLeft",from:"l",diameter:15,x:197,y:50,label:String.fromCharCode(8592),labelSize:20,labelOffset:0},{name:"dpadRight",x:243,y:50,from:"l",diameter:15,label:String.fromCharCode(8594),labelSize:20,labelOffset:0},{name:"home"}],n.prototype.initButtons=function(e,t,i){var a;switch(e){case"playstation":a=n.PlaystationControllerButtons;break;case"xbox":a=n.XBoxControllerButtons;break;default:return}var o=this.initialDPR,r=[];for(var l in a)if(a.hasOwnProperty(l)){var s=a[l];if(s.x&&s.y&&s.diameter){s.name||console.error("[MobileWidgetControls] A button must have a name property.");var d={held:!1};d.id=s.name,d.modelOriginX="l"===s.from?o*s.x:t-o*s.x,d.modelOriginY=i-o*s.y,d.BUTTON_DIAMETER=o*s.diameter,d.style=s.theme,d.BUTTON_LABEL=s.label,d.BUTTON_LABEL_SIZE=o*s.labelSize,d.BUTTON_LABEL_OFFSET=o*s.labelOffset,r.push(d)}}this.buttons=r},n.prototype.notifyButtonChanged=function(e,t){this.buttonPressCallback&&this.buttonPressCallback(e.id,t)},n.prototype.updateButtonModelHold=function(e,t,i,a){for(var n=!1,o=0,r=i.length;o<r;++o){var l=i[o];if(!(this.distanceToObjectCenter(e,t,l)>l.BUTTON_DIAMETER)){n=!0,l.held!==a&&(l.held=a,this.notifyButtonChanged(l,a));break}}return n},n.prototype.updateButtonModelMove=function(e,t,i){for(var a=!1,n=0,o=i.length;n<o;++n){var r=i[n];if(r.held)if(!(this.distanceToObjectCenter(e,t,r)<r.BUTTON_DIAMETER)){for(var l=!1,s=this.fingers,d=this.currentDPR,h=0;h<s.length;++h){var c=s[h];if(this.distanceToObjectCenter(d*c.x,d*c.y,r)<r.BUTTON_DIAMETER){l=!0;break}}l||(a=!0,r.held=!1,this.notifyButtonChanged(r,!1))}}return a},n.prototype.drawButton=function(e,t){e.beginPath(),e.globalAlpha=this.minOpacity+.2;var i=t.modelOriginX,a=t.modelOriginY;if(e.arc(i,a,t.BUTTON_DIAMETER,0,2*Math.PI),"gradient"===t.style){var n=e.createRadialGradient(i,a,2,i,a,t.BUTTON_DIAMETER);n.addColorStop(0,t.held?"silver":"black"),n.addColorStop(.7,t.held?"silver":"black"),n.addColorStop(.9,"silver"),n.addColorStop(1,"silver"),e.fillStyle=n}else e.fillStyle=t.held?"#222222":"black";e.fill(),"gradient"!==t.style&&(e.lineWidth=1,e.strokeStyle="white",e.stroke()),e.closePath(),e.beginPath(),e.font="".concat(t.BUTTON_LABEL_SIZE,"px Arial"),e.fillStyle="white",e.textAlign="center",e.textBaseline="middle",e.globalAlpha=this.minOpacity+.3,e.fillText(t.BUTTON_LABEL,i,a+(t.BUTTON_LABEL_OFFSET||0)),e.closePath()},n.DefaultSticks=[{name:"left",from:"l",x:100,y:120,head:25,base:70,grab:150,reach:55,label:String.fromCharCode(10021),labelSize:30,labelOffset:2,theme:"gradient"},{name:"right",from:"r",x:100,y:120,head:25,base:70,grab:150,reach:55,label:String.fromCharCode(10021),labelSize:30,labelOffset:2,theme:"gradient"}],n.PlaystationSticks=[{name:"left",from:"l",x:155,y:80,head:25,base:70,grab:150,reach:55,theme:"gradient"},{name:"right",from:"r",x:240,y:100,head:25,base:70,grab:150,reach:55,theme:"gradient"}],n.XBoxSticks=[{name:"left",from:"l",x:90,y:90,head:35,base:80,grab:150,reach:65,theme:"dark"},{name:"right",from:"r",x:240,y:80,head:30,base:70,grab:130,reach:55,theme:"dark"}],n.prototype.initStick=function(e,t,i,a){var n=this.initialDPR;i.x=i.y=i.lastHeldX=i.lastHeldY=i.timeStampReleased=0,i.modelOriginX="l"===a.from?n*a.x:e-n*a.x,i.modelOriginY=t-n*a.y,i.held=!1,i.needsUpdate=!0,i.STICK_HEAD_DIAMETER=n*a.head,i.STICK_BASE_DIAMETER=n*a.base,i.STICK_GRAB_DISTANCE=n*a.grab,i.STICK_REACH_DISTANCE=n*a.reach,i.STICK_LABEL=a.label,i.STICK_LABEL_SIZE=n*a.labelSize,i.STICK_LABEL_OFFSET=n*a.labelOffset,i.style=a.theme},n.prototype.initSticks=function(e,t,i){var a;switch(e){case"playstation":a=n.PlaystationSticks;break;case"xbox":a=n.XBoxSticks;break;default:a=n.DefaultSticks}this.initStick(t,i,this.leftStick,a[0]),this.initStick(t,i,this.rightStick,a[1])},n.prototype.notifyStickMoved=function(e,t,i){var a=e/i.STICK_REACH_DISTANCE,n=t/i.STICK_REACH_DISTANCE;i===this.leftStick?this.leftStickMoveCallback&&this.leftStickMoveCallback(a,n):i===this.rightStick&&this.rightStickMoveCallback&&this.rightStickMoveCallback(a,n)},n.prototype.updateStickModelFromMove=function(e,t,i,a){var n=e-a.modelOriginX,o=t-a.modelOriginY;i>a.STICK_REACH_DISTANCE&&(n*=a.STICK_REACH_DISTANCE/i,o*=a.STICK_REACH_DISTANCE/i),a.x=n,a.y=o,a.lastHeldX=n,a.lastHeldY=o,this.notifyStickMoved(n,o,a)},n.prototype.updateStickModelMove=function(e,t,i){var a=this.distanceToObjectCenter(e,t,i);if(a<i.STICK_GRAB_DISTANCE)i.needsUpdate=!0,i.held&&this.updateStickModelFromMove(e,t,a,i);else if(i.held){for(var n=!1,o=this.fingers,r=this.currentDPR,l=0;l<o.length;++l){var s=o[l];if(this.distanceToObjectCenter(r*s.x,r*s.y,i)<i.STICK_GRAB_DISTANCE){n=!0;break}}n||(i.held=!1,i.needsUpdate=!0,this.updateStickModelFromMove(e,t,a,i),i.timeStampReleased=this.getTimeInMilliseconds())}},n.prototype.updateStickModelHold=function(e,t,i,a){if(this.distanceToObjectCenter(e,t,i)<i.STICK_GRAB_DISTANCE){var n=i.held;i.held=a,n&&!a&&(i.timeStampReleased=this.getTimeInMilliseconds()),i.needsUpdate=!0}},n.prototype.updateMove=function(e){var t=this.currentDPR,i=e.clientX*t,a=e.clientY*t;this.updateButtonModelMove(i,a,this.buttons),this.updateStickModelMove(i,a,this.leftStick),this.updateStickModelMove(i,a,this.rightStick)},n.prototype.getClosestStick=function(e,t){return this.distanceToObjectCenter(e,t,this.leftStick)<=this.distanceToObjectCenter(e,t,this.rightStick)?this.leftStick:this.rightStick},n.prototype.updateDown=function(e){var t=this.currentDPR,i=e.clientX*t,a=e.clientY*t;if(!this.updateButtonModelHold(i,a,this.buttons,!0)){var n=this.getClosestStick(i,a);this.updateStickModelHold(i,a,n,!0),this.updateStickModelMove(i,a,n)}},n.prototype.updateUp=function(e){var t=this.currentDPR,i=t*e.clientX,a=t*e.clientY;this.updateButtonModelHold(i,a,this.buttons,!1),this.updateStickModelHold(i,a,this.leftStick,!1),this.updateStickModelHold(i,a,this.rightStick,!1)},n.prototype.drawStick=function(e,t){var i=t.modelOriginX,a=t.modelOriginY;if(e.beginPath(),e.globalAlpha=this.minOpacity,e.arc(i,a,t.STICK_BASE_DIAMETER,0,2*Math.PI),"gradient"===t.style){var n=e.createRadialGradient(i,a,2,i,a,t.STICK_BASE_DIAMETER);n.addColorStop(0,"gray"),n.addColorStop(.7,"gray"),n.addColorStop(.9,"silver"),n.addColorStop(1,"white"),e.fillStyle=n}else e.fillStyle="black";e.fill(),"gradient"!==t.style&&(e.lineWidth=1,e.strokeStyle="white",e.stroke()),e.closePath();var o=t.x,r=t.y;if(e.beginPath(),e.globalAlpha=this.minOpacity,e.arc(i+o,a+r,t.STICK_HEAD_DIAMETER,0,2*Math.PI),"gradient"===t.style){e.globalAlpha=this.minOpacity+.05;var l=e.createRadialGradient(i+o,a+r,2,i+o,a+r,t.STICK_HEAD_DIAMETER);l.addColorStop(0,"darkgray"),l.addColorStop(.7,"darkgray"),l.addColorStop(.9,"whitesmoke"),l.addColorStop(1,"white"),e.fillStyle=l}else e.fillStyle="black";e.fill(),"gradient"!==t.style&&(e.lineWidth=1,e.strokeStyle="white",e.stroke()),e.closePath(),t.STICK_LABEL&&t.STICK_LABEL_SIZE&&(e.beginPath(),e.font="".concat(t.STICK_LABEL_SIZE,"px Arial"),e.fillStyle="white",e.textAlign="center",e.textBaseline="middle",e.globalAlpha=this.minOpacity,e.fillText(t.STICK_LABEL,i+o,a+r+(t.STICK_LABEL_OFFSET||0)),e.closePath())},n.prototype.draw=function(){var e=this.canvas,t=e.getContext("2d");t.clearRect(0,0,e.width,e.height),this.drawStick(t,this.leftStick),this.drawStick(t,this.rightStick);for(var i=this.buttons,a=0,n=i.length;a<n;++a)this.drawButton(t,i[a])},n.prototype.interpolateStick=function(e,t){var i=t-e.timeStampReleased,a=this.TIME_MS_TO_GET_TO_ORIGINAL_POSITION,n=this.smootherstep(0,a,i),o=e.modelOriginX,r=e.modelOriginY,l=(o+e.lastHeldX)*(1-n)+o*n-o,s=(r+e.lastHeldY)*(1-n)+r*n-r;e.x===e.y&&e.x===e.y&&(e.needsUpdate=!1),e.x=l,e.y=s,e.needsUpdate&&this.notifyStickMoved(l,s,e)},n.prototype.animate=function(){var e=this.getTimeInMilliseconds(),t=this.leftStick;!t.held&&t.needsUpdate&&this.interpolateStick(t,e);var i=this.rightStick;!i.held&&i.needsUpdate&&this.interpolateStick(i,e),this.draw()},n.prototype.resize=function(){var e=this;this._resizeRequest&&clearTimeout(this._resizeRequest),this._resizeRequest=setTimeout((function(){window.scrollTo(0,document.body.scrollHeight),e.init()}),100)},n.prototype.getTimeInMilliseconds=function(){return performance.now()},n.prototype.distanceToObjectCenter=function(e,t,i){return Math.sqrt(Math.pow(e-i.modelOriginX,2)+Math.pow(t-i.modelOriginY,2))},n.prototype.clamp=function(e,t,i){return Math.min(i,Math.max(t,e))},n.prototype.smootherstep=function(e,t,i){var a=this.clamp((i-e)/(t-e),0,1);return a*a*a*(a*(6*a-15)+10)},n.prototype.makeDocumentUnselectable=function(){var e="mobile-widget-controls-style";if(!document.getElementById(e)){var t=document.getElementsByTagName("head")[0],i=document.createElement("style");i.id=e,i.innerText="\n            *.noselect {\n               -webkit-touch-callout: none; /* iOS Safari */\n                 -webkit-user-select: none; /* Safari */\n                  -khtml-user-select: none; /* Konqueror HTML */\n                    -moz-user-select: none; /* Firefox */\n                     -ms-user-select: none; /* Internet Explorer/Edge */\n                         user-select: none; /* Non-prefixed version, currently\n                                               supported by Chrome and Opera */\n            }\n        ",t.appendChild(i)}document.body.className+=" noselect"};var o=function(e,t,i,a){var o=this;this.camera=t,this.controlsType=i,this.cameraMovementSpeed=1/4,this.cameraRotationSpeed=1/75,this.leftX=0,this.leftY=0,this.rightX=0,this.rightY=0,this.rx=0,this.ry=0;this.widgetControls=new n(e,(function(e,t){o.leftX=e,o.leftY=t}),(function(e,t){o.rightX=e,o.rightY=t}),(function(e,t){console.log("Button ".concat(e," ").concat(t?"pressed":"released","."))}),a||"default"),this.widgetControls.makeDocumentUnselectable()};o.prototype.animate=function(){var e=this.cameraRotationSpeed,t=this.rightX*e,i=this.rightY*e;switch(this.controlsType){case"quaternion":var n=new a.g;Math.abs(i)>0&&(n.set(-i,0,0,1).normalize(),this.camera.quaternion.multiply(n)),Math.abs(t)>0&&(n.set(0,-t,0,1).normalize(),this.camera.quaternion.multiply(n));break;case"spherical":Math.abs(i)>0&&(this.rx-=2*i,this.rx=Math.max(-Math.PI/2,Math.min(Math.PI/2,this.rx)),this.updateQuaternionFromRotation()),Math.abs(t)>0&&(this.rx<-Math.PI/2||this.rx>Math.PI/2?this.ry+=2*t:this.ry-=2*t,this.updateQuaternionFromRotation())}var o=this.cameraMovementSpeed,r=this.leftX*o,l=this.leftY*o,s=this.getForwardVector(r,-l);this.camera.position.x+=s.x*o,this.camera.position.z+=s.z*o,"quaternion"===this.controlsType&&(this.camera.position.y+=s.y*o),this.widgetControls.animate()},o.prototype.updateQuaternionFromRotation=function(){var e=new a.g,t=new a.g;e.setFromAxisAngle(new a.j(1,0,0),this.rx),t.setFromAxisAngle(new a.j(0,1,0),this.ry),t.multiply(e),this.camera.quaternion.copy(t)},o.prototype.getForwardVector=function(e,t){var i=new a.j(e,0,-t);i.normalize();var n=new a.g;return this.camera.getWorldQuaternion(n),i.applyQuaternion(n),i};var r,l,s,d,h,c=window.innerWidth,m=window.innerHeight,f=c/m;!function(){"ontouchstart"in window||navigator.msMaxTouchPoints>0?console.log("[main] Touch device detected."):console.log("[main] This is not a touch device.");(d=new a.k({antialias:!0})).setPixelRatio(window.devicePixelRatio),d.setSize(c,m),document.body.appendChild(d.domElement),(s=new a.h).background=new a.a(1118481),l=new a.e(90,f,.1,5e3),s.add(l),l.position.set(0,0,30);var e=[];e[0]=new a.f(16777215,1,0),e[1]=new a.f(16777215,1,0),e[2]=new a.f(16777215,1,0),e[0].position.set(0,200,0),e[1].position.set(100,200,100),e[2].position.set(-100,-200,-100),s.add(e[0]),s.add(e[1]),s.add(e[2]);var t=new a.i(10,3,100,16),i=new a.d({color:2200782,shininess:1});r=new a.c(t,i),s.add(r);var n=new a.b(150,20,65280,16777215);n.position.set(0,-15,0),s.add(n);var p=function(){l.aspect=window.innerWidth/window.innerHeight,l.updateProjectionMatrix(),d.setSize(window.innerWidth,window.innerHeight)};window.addEventListener("resize",p,!1),window.addEventListener("orientationchange",p,!1);var u=document.getElementById("widget");(h=new o(u,l,"spherical","default")).widgetControls.minOpacity=.3}(),function e(){requestAnimationFrame(e),h.animate(),d.render(s,l)}()}],[[1,1,2]]]);